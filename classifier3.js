var No_crop = 
    /* color: #2640d6 */
    /* shown: false */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Point([72.12326247571131, 34.15080992471748]),
            {
              "Class": 0,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Point([72.123745273334, 34.15087207619645]),
            {
              "Class": 0,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12341267941615, 34.151200590396975]),
            {
              "Class": 0,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12990021934917, 34.15026831703645]),
            {
              "Class": 0,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12944960823467, 34.15268332778197]),
            {
              "Class": 0,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Point([72.13065123787334, 34.153251555569135]),
            {
              "Class": 0,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11434340706279, 34.153155446258914]),
            {
              "Class": 0,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11438632240703, 34.15276478962137]),
            {
              "Class": 0,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11230492821147, 34.15239188841808]),
            {
              "Class": 0,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Point([72.1095368885081, 34.15519748563564]),
            {
              "Class": 0,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12631309219957, 34.158975801283916]),
            {
              "Class": 0,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15459812836511, 34.15930897778991]),
            {
              "Class": 0,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15464104370935, 34.15994818362799]),
            {
              "Class": 0,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Point([72.1562718267904, 34.15913141975389]),
            {
              "Class": 0,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15635765747888, 34.15728479404584]),
            {
              "Class": 0,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15558518128259, 34.15856323152958]),
            {
              "Class": 0,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15507019715173, 34.1590959081019]),
            {
              "Class": 0,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15837467865808, 34.161226580787144]),
            {
              "Class": 0,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Point([72.1577309484945, 34.16072942863641]),
            {
              "Class": 0,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15760220246179, 34.161581687673994]),
            {
              "Class": 0,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Point([72.16039169983728, 34.16175924055735]),
            {
              "Class": 0,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Point([72.16155041413171, 34.16229189696704]),
            {
              "Class": 0,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15953339295251, 34.16062289565181]),
            {
              "Class": 0,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15972910711942, 34.172123387117026]),
            {
              "Class": 0,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Point([72.16063032934842, 34.17247844816656]),
            {
              "Class": 0,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Point([72.16144572088895, 34.172940025297756]),
            {
              "Class": 0,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Point([72.16230402777371, 34.17343710553888]),
            {
              "Class": 0,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Point([72.16002951452909, 34.171661805519435]),
            {
              "Class": 0,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Point([72.1596003610867, 34.171164714821884]),
            {
              "Class": 0,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15917120764432, 34.171590792741895]),
            {
              "Class": 0,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Point([72.16011534521756, 34.17052559390877]),
            {
              "Class": 0,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Point([72.16277609656034, 34.17073863475088]),
            {
              "Class": 0,
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Point([72.16260443518338, 34.16974443955364]),
            {
              "Class": 0,
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Point([72.16552267859159, 34.169886468155966]),
            {
              "Class": 0,
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Point([72.16449271032987, 34.17024153861612]),
            {
              "Class": 0,
              "system:index": "34"
            }),
        ee.Feature(
            ee.Geometry.Point([72.16427813360868, 34.171874843493526]),
            {
              "Class": 0,
              "system:index": "35"
            }),
        ee.Feature(
            ee.Geometry.Point([72.16590891668973, 34.17244294212882]),
            {
              "Class": 0,
              "system:index": "36"
            }),
        ee.Feature(
            ee.Geometry.Point([72.16535101721463, 34.173117554291416]),
            {
              "Class": 0,
              "system:index": "37"
            }),
        ee.Feature(
            ee.Geometry.Point([72.17565069983182, 34.16892777045237]),
            {
              "Class": 0,
              "system:index": "38"
            }),
        ee.Feature(
            ee.Geometry.Point([72.17710982153592, 34.168466171378114]),
            {
              "Class": 0,
              "system:index": "39"
            }),
        ee.Feature(
            ee.Geometry.Point([72.17736731360135, 34.16782703003097]),
            {
              "Class": 0,
              "system:index": "40"
            }),
        ee.Feature(
            ee.Geometry.Point([72.17796812842069, 34.16779152203645]),
            {
              "Class": 0,
              "system:index": "41"
            }),
        ee.Feature(
            ee.Geometry.Point([72.17822562048612, 34.16889226292089]),
            {
              "Class": 0,
              "system:index": "42"
            }),
        ee.Feature(
            ee.Geometry.Point([72.17758189032254, 34.169779946726635]),
            {
              "Class": 0,
              "system:index": "43"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15127478430448, 34.17049008704948]),
            {
              "Class": 0,
              "system:index": "44"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15251932928739, 34.171164714821884]),
            {
              "Class": 0,
              "system:index": "45"
            }),
        ee.Feature(
            ee.Geometry.Point([72.1532059747952, 34.17162629913812]),
            {
              "Class": 0,
              "system:index": "46"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15397845099149, 34.171768324573705]),
            {
              "Class": 0,
              "system:index": "47"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15518008063016, 34.171306741034215]),
            {
              "Class": 0,
              "system:index": "48"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15530882666287, 34.1722654117161]),
            {
              "Class": 0,
              "system:index": "49"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15590964148221, 34.17322407150835]),
            {
              "Class": 0,
              "system:index": "50"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15642462561307, 34.17141326053662]),
            {
              "Class": 0,
              "system:index": "51"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15676794836698, 34.17233642392599]),
            {
              "Class": 0,
              "system:index": "52"
            }),
        ee.Feature(
            ee.Geometry.Point([72.1563387949246, 34.172833507722316]),
            {
              "Class": 0,
              "system:index": "53"
            }),
        ee.Feature(
            ee.Geometry.Point([72.1543217737454, 34.17354362235249]),
            {
              "Class": 0,
              "system:index": "54"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15324889013944, 34.17308204852255]),
            {
              "Class": 0,
              "system:index": "55"
            }),
        ee.Feature(
            ee.Geometry.Point([72.152090175845, 34.17112920823145]),
            {
              "Class": 0,
              "system:index": "56"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15075980017362, 34.17041907328605]),
            {
              "Class": 0,
              "system:index": "57"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15045939276395, 34.17006400357277]),
            {
              "Class": 0,
              "system:index": "58"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15389262030301, 34.177832955752294]),
            {
              "Class": 0,
              "system:index": "59"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15492258856473, 34.17893356567391]),
            {
              "Class": 0,
              "system:index": "60"
            }),
        ee.Feature(
            ee.Geometry.Point([72.1566821176785, 34.18046019437764]),
            {
              "Class": 0,
              "system:index": "61"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15848456213651, 34.18138325879787]),
            {
              "Class": 0,
              "system:index": "62"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15809832403836, 34.18095723032038]),
            {
              "Class": 0,
              "system:index": "63"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15788374731717, 34.17950161679054]),
            {
              "Class": 0,
              "system:index": "64"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15852747748075, 34.18003416123903]),
            {
              "Class": 0,
              "system:index": "65"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15749750921903, 34.18063770755048]),
            {
              "Class": 0,
              "system:index": "66"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15749750921903, 34.18360577043033]),
            {
              "Class": 0,
              "system:index": "67"
            }),
        ee.Feature(
            ee.Geometry.Point([72.1586991388577, 34.18406728669465]),
            {
              "Class": 0,
              "system:index": "68"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15895663092313, 34.18332175916653]),
            {
              "Class": 0,
              "system:index": "69"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15990076849637, 34.18303774694661]),
            {
              "Class": 0,
              "system:index": "70"
            }),
        ee.Feature(
            ee.Geometry.Point([72.1598149378079, 34.184599802323724]),
            {
              "Class": 0,
              "system:index": "71"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15955744574246, 34.185451820338216]),
            {
              "Class": 0,
              "system:index": "72"
            }),
        ee.Feature(
            ee.Geometry.Point([72.16075907538114, 34.18200819463406]),
            {
              "Class": 0,
              "system:index": "73"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15891371557889, 34.18254072326096]),
            {
              "Class": 0,
              "system:index": "74"
            }),
        ee.Feature(
            ee.Geometry.Point([72.15908537695584, 34.18271823205627]),
            {
              "Class": 0,
              "system:index": "75"
            }),
        ee.Feature(
            ee.Geometry.Point([72.13198635589325, 34.178806230909466]),
            {
              "Class": 0,
              "system:index": "76"
            }),
        ee.Feature(
            ee.Geometry.Point([72.13196489822113, 34.17873522414381]),
            {
              "Class": 0,
              "system:index": "77"
            }),
        ee.Feature(
            ee.Geometry.Point([72.13198635589325, 34.17866421731842]),
            {
              "Class": 0,
              "system:index": "78"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12490303346289, 34.17619100780448]),
            {
              "Class": 0,
              "system:index": "79"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12531072923315, 34.17652829957901]),
            {
              "Class": 0,
              "system:index": "80"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12486011811865, 34.1761022465871]),
            {
              "Class": 0,
              "system:index": "81"
            }),
        ee.Feature(
            ee.Geometry.Point([72.1250317794956, 34.17475306458786]),
            {
              "Class": 0,
              "system:index": "82"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12561113664282, 34.17454003387927]),
            {
              "Class": 0,
              "system:index": "83"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12509615251196, 34.174611044175236]),
            {
              "Class": 0,
              "system:index": "84"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12389452287329, 34.17459329160685]),
            {
              "Class": 0,
              "system:index": "85"
            })]),
    AOI = 
    /* color: #d6bd29 */
    /* shown: false */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.Polygon(
        [[[72.08331545029282, 34.19924172854143],
          [72.08331545029282, 34.14655104412996],
          [72.18347986374496, 34.14655104412996],
          [72.18347986374496, 34.19924172854143]]], null, false),
    Crop_fields = 
    /* color: #98ff00 */
    /* shown: false */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Point([72.11786491700781, 34.17542765828385]),
            {
              "Class": 1,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11880905458105, 34.17596022844511]),
            {
              "Class": 1,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11880905458105, 34.17539215348694]),
            {
              "Class": 1,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11649162599218, 34.17493058976755]),
            {
              "Class": 1,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11614830323828, 34.17638628215405]),
            {
              "Class": 1,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Point([72.1166203720249, 34.178410007894705]),
            {
              "Class": 1,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11743576356542, 34.177735438040735]),
            {
              "Class": 1,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11962444612158, 34.178552021913596]),
            {
              "Class": 1,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12082607576025, 34.17791295694621]),
            {
              "Class": 1,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12074024507177, 34.175924723872264]),
            {
              "Class": 1,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12086899110449, 34.17585371468176]),
            {
              "Class": 1,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Point([72.1206544143833, 34.174788569653664]),
            {
              "Class": 1,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11983902284277, 34.174220486808075]),
            {
              "Class": 1,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12597591706884, 34.18050469043481]),
            {
              "Class": 1,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12666256257666, 34.18121474051071]),
            {
              "Class": 1,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Point([72.1270488006748, 34.180895218716074]),
            {
              "Class": 1,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Point([72.1270488006748, 34.18046918777413]),
            {
              "Class": 1,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12893707582128, 34.18181827837675]),
            {
              "Class": 1,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Point([72.14678985902441, 34.178232490034944]),
            {
              "Class": 1,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Point([72.14696152040136, 34.179617119436465]),
            {
              "Class": 1,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Point([72.14696152040136, 34.17858752538099]),
            {
              "Class": 1,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Point([72.14704735108984, 34.178232490034944]),
            {
              "Class": 1,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Point([72.16444107852269, 34.181374340618426]),
            {
              "Class": 1,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Point([72.16431233248997, 34.18112582424172]),
            {
              "Class": 1,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Point([72.17573740760858, 34.18169386059855]),
            {
              "Class": 1,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Point([72.17457869331415, 34.181871371175724]),
            {
              "Class": 1,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Point([72.17427828590448, 34.181551851867894]),
            {
              "Class": 1,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Point([72.17500784675653, 34.181303336014075]),
            {
              "Class": 1,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Point([72.16681101600702, 34.187219811149056]),
            {
              "Class": 1,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Point([72.16745474617059, 34.18792980470569]),
            {
              "Class": 1,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12449648658807, 34.19123119623587]),
            {
              "Class": 1,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12556937019403, 34.192544617146865]),
            {
              "Class": 1,
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Point([72.1256552008825, 34.191941156025166]),
            {
              "Class": 1,
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12544062416131, 34.19151518086878]),
            {
              "Class": 1,
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12501147071893, 34.192544617146865]),
            {
              "Class": 1,
              "system:index": "34"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12393858711297, 34.192225138267396]),
            {
              "Class": 1,
              "system:index": "35"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12346651832635, 34.19140868674349]),
            {
              "Class": 1,
              "system:index": "36"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12243655006463, 34.19133769058527]),
            {
              "Class": 1,
              "system:index": "37"
            }),
        ee.Feature(
            ee.Geometry.Point([72.1179884619918, 34.17156253189737]),
            {
              "Class": 1,
              "system:index": "38"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12022005989219, 34.16957414920201]),
            {
              "Class": 1,
              "system:index": "39"
            }),
        ee.Feature(
            ee.Geometry.Point([72.1176451392379, 34.167727751898475]),
            {
              "Class": 1,
              "system:index": "40"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11575686409141, 34.16914806110146]),
            {
              "Class": 1,
              "system:index": "41"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11713015510703, 34.16403483612522]),
            {
              "Class": 1,
              "system:index": "42"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11661517097617, 34.16318260185089]),
            {
              "Class": 1,
              "system:index": "43"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11713015510703, 34.16233035897353]),
            {
              "Class": 1,
              "system:index": "44"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12794033516727, 34.158904097670515]),
            {
              "Class": 1,
              "system:index": "45"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12918488015018, 34.1589396094032]),
            {
              "Class": 1,
              "system:index": "46"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12897030342899, 34.15847795571347]),
            {
              "Class": 1,
              "system:index": "47"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12815491188846, 34.15844244378665]),
            {
              "Class": 1,
              "system:index": "48"
            }),
        ee.Feature(
            ee.Geometry.Point([72.13008610237918, 34.15837141988819]),
            {
              "Class": 1,
              "system:index": "49"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12575165261111, 34.16146090424903]),
            {
              "Class": 1,
              "system:index": "50"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11695400704227, 34.16153192554877]),
            {
              "Class": 1,
              "system:index": "51"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11652485359988, 34.162561727681535]),
            {
              "Class": 1,
              "system:index": "52"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11819855202518, 34.16337845837254]),
            {
              "Class": 1,
              "system:index": "53"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11927143563113, 34.16451476619033]),
            {
              "Class": 1,
              "system:index": "54"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11858479012332, 34.16376906591]),
            {
              "Class": 1,
              "system:index": "55"
            }),
        ee.Feature(
            ee.Geometry.Point([72.1186706208118, 34.16281029872826]),
            {
              "Class": 1,
              "system:index": "56"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11940018166385, 34.16312988899864]),
            {
              "Class": 1,
              "system:index": "57"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12043014992557, 34.162916828952795]),
            {
              "Class": 1,
              "system:index": "58"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12107388008914, 34.16376906591]),
            {
              "Class": 1,
              "system:index": "59"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12227550972781, 34.16444374739979]),
            {
              "Class": 1,
              "system:index": "60"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12184635628543, 34.163449478059235]),
            {
              "Class": 1,
              "system:index": "61"
            }),
        ee.Feature(
            ee.Geometry.Point([72.16670629420359, 34.15851085531464]),
            {
              "Class": 1,
              "system:index": "62"
            }),
        ee.Feature(
            ee.Geometry.Point([72.1482097808369, 34.15495959008882]),
            {
              "Class": 1,
              "system:index": "63"
            }),
        ee.Feature(
            ee.Geometry.Point([72.14726564326365, 34.15506613021854]),
            {
              "Class": 1,
              "system:index": "64"
            }),
        ee.Feature(
            ee.Geometry.Point([72.14756605067332, 34.15428483281265]),
            {
              "Class": 1,
              "system:index": "65"
            }),
        ee.Feature(
            ee.Geometry.Point([72.13494893946726, 34.1519764118878]),
            {
              "Class": 1,
              "system:index": "66"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12344067436582, 34.14856118227738]),
            {
              "Class": 1,
              "system:index": "67"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12344067436582, 34.149555626927544]),
            {
              "Class": 1,
              "system:index": "68"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12052243095762, 34.14905840606587]),
            {
              "Class": 1,
              "system:index": "69"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11983578544981, 34.148951858357606]),
            {
              "Class": 1,
              "system:index": "70"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12013619285948, 34.14866773047846]),
            {
              "Class": 1,
              "system:index": "71"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12515728813536, 34.14909392193878]),
            {
              "Class": 1,
              "system:index": "72"
            }),
        ee.Feature(
            ee.Geometry.Point([72.12438481193907, 34.149235985281024]),
            {
              "Class": 1,
              "system:index": "73"
            }),
        ee.Feature(
            ee.Geometry.Point([72.11362393820379, 34.14931160651306]),
            {
              "Class": 1,
              "system:index": "74"
            }),
        ee.Feature(
            ee.Geometry.Point([72.1139672609577, 34.15023501158714]),
            {
              "Class": 1,
              "system:index": "75"
            })]).aside(print,'crop');
           
// FeatureCollection (76 elements, 2 columns)
// type: FeatureCollection
// columns: Object (2 properties)
// Class: Integer
// system:index: String
// features: List (76 elements)
// 0: Feature 0 (Point, 1 property)
// type: Feature
// id: 0
// geometry: Point (72.12, 34.18)
// type: Point
// coordinates: [72.11786491700781,34.17542765828385]
// properties: Object (1 property)
// Class: 1



var startDate1 = ee.Date.fromYMD(2019,4,1);
var endDate1 = ee.Date.fromYMD(2019,4,27);

var startDate2 = ee.Date.fromYMD(2019,6,1);
var endDate2 = ee.Date.fromYMD(2019,6,27);

var startDate3 = ee.Date.fromYMD(2019,8,1);
var endDate3 = ee.Date.fromYMD(2019,8,27);

var startDateS2 = ee.Date.fromYMD(2020,5,4);
var endDateS2 = ee.Date.fromYMD(2020,5,29);
var S2 = ee.ImageCollection("COPERNICUS/S2").filterDate(startDateS2,endDateS2).filterBounds(AOI).filterMetadata('CLOUDY_PIXEL_PERCENTAGE', 'less_than', 0.1)
var img = ee.Image(S2.median()).clip(AOI).divide(10000);
Map.centerObject(AOI, 13)

var viz = {min:0,max:0.3,bands:"B4,B3,B2"};
Map.addLayer(img,viz,"True Color Tessalonica");


var collectionVV1 = ee.ImageCollection('COPERNICUS/S1_GRD')
    .filter(ee.Filter.eq('instrumentMode', 'IW'))
    .filter(ee.Filter.listContains('transmitterReceiverPolarisation', 'VV'))
    .filter(ee.Filter.eq('orbitProperties_pass', 'DESCENDING'))
    .filterBounds(AOI)
    .filterDate(startDate1,endDate1)
    .select(['VV']);


var collectionVV2 = ee.ImageCollection('COPERNICUS/S1_GRD')
    .filter(ee.Filter.eq('instrumentMode', 'IW'))
    .filter(ee.Filter.listContains('transmitterReceiverPolarisation', 'VV'))
    .filter(ee.Filter.eq('orbitProperties_pass', 'DESCENDING'))
    .filterBounds(AOI)
    .filterDate(startDate2,endDate2)
    .select(['VV']);


var collectionVV3 = ee.ImageCollection('COPERNICUS/S1_GRD')
    .filter(ee.Filter.eq('instrumentMode', 'IW'))
    .filter(ee.Filter.listContains('transmitterReceiverPolarisation', 'VV'))
    .filter(ee.Filter.eq('orbitProperties_pass', 'DESCENDING'))
    .filterBounds(AOI)
    .filterDate(startDate3,endDate3)
    .select(['VV']);



var VV1 = ee.Image(collectionVV1.median()).clip(AOI);
var VV2 = ee.Image(collectionVV2.median()).clip(AOI);
var VV3 = ee.Image(collectionVV3.median()).clip(AOI);


var RGBVV = VV1.addBands(VV2).addBands(VV3).aside(print,'RGBVV')


Map.addLayer(RGBVV, {min: -25, max: 5}, 'RGB VV');


var collectionVH1 = ee.ImageCollection('COPERNICUS/S1_GRD')
    .filter(ee.Filter.eq('instrumentMode', 'IW'))
    .filter(ee.Filter.listContains('transmitterReceiverPolarisation', 'VH'))
    .filter(ee.Filter.eq('orbitProperties_pass', 'DESCENDING'))
    .filterBounds(AOI)
    .filterDate(startDate1,endDate1)
    .select(['VH']);


var collectionVH2 = ee.ImageCollection('COPERNICUS/S1_GRD')
    .filter(ee.Filter.eq('instrumentMode', 'IW'))
    .filter(ee.Filter.listContains('transmitterReceiverPolarisation', 'VH'))
    .filter(ee.Filter.eq('orbitProperties_pass', 'DESCENDING'))
    .filterBounds(AOI)
    .filterDate(startDate2,endDate2)
    .select(['VH']);


var collectionVH3 = ee.ImageCollection('COPERNICUS/S1_GRD')
    .filter(ee.Filter.eq('instrumentMode', 'IW'))
    .filter(ee.Filter.listContains('transmitterReceiverPolarisation', 'VH'))
    .filter(ee.Filter.eq('orbitProperties_pass', 'DESCENDING'))
    .filterBounds(AOI)
    .filterDate(startDate3,endDate3)
    .select(['VH']);



var VH1 = ee.Image(collectionVH1.median()).clip(AOI);
var VH2 = ee.Image(collectionVH2.median()).clip(AOI);
var VH3 = ee.Image(collectionVH3.median()).clip(AOI);


var RGBVH = VH1.addBands(VH2).addBands(VH3).aside(print,'RGBVH')
Map.addLayer(RGBVH, {min: -25, max: 5}, 'RGB VH');


// ----------------- Segmentation ----------------------------------------

var img_seg = RGBVH.addBands(RGBVV).aside(print,'RGBVH+RGBVV')


// Image (6 bands)
// type: Image
// bands: List (6 elements)
// 0: "VH", double, EPSG:4326, 1x1 px
// 1: "VH_1", double, EPSG:4326, 1x1 px
// 2: "VH_2", double, EPSG:4326, 1x1 px
// 3: "VV", double, EPSG:4326, 1x1 px
// 4: "VV_1", double, EPSG:4326, 1x1 px
// 5: "VV_2", double, EPSG:4326, 1x1 px
// properties: Object (1 property)
// system:footprint: Polygon, 5 vertices

var seeds = ee.Algorithms.Image.Segmentation.seedGrid(20).aside(print,'seeds');

// Image (1 band)
// type: Image
// bands: List (1 element)
// 0: "seeds", int ∈ [0, 1], EPSG:4326
// id: seeds
// crs: EPSG:4326
// crs_transform: [1,0,0,0,1,0]
// data_type: int ∈ [0, 1]

var snic_pred = ee.Algorithms.Image.Segmentation.SNIC({
  image: img_seg, 
  compactness: 4,
  connectivity: 8,
  neighborhoodSize: 128,
  size: 10,
  seeds: seeds
}).aside(print,'SNIC')


// Image (7 bands)
// type: Image
// bands: List (7 elements)
// 0: "clusters", signed int32, EPSG:4326, 1x1 px
// 1: "VH_mean", float, EPSG:4326, 1x1 px
// 2: "VH_1_mean", float, EPSG:4326, 1x1 px
// 3: "VH_2_mean", float, EPSG:4326, 1x1 px
// 4: "VV_mean", float, EPSG:4326, 1x1 px
// 5: "VV_1_mean", float, EPSG:4326, 1x1 px
// 6: "VV_2_mean", float, EPSG:4326, 1x1 px
// properties: Object (1 property)
// system:footprint: Polygon, 5 vertices
// type: Polygon
// coordinates: List (1 element)
// 0: List (5 elements)
// geodesic: false


var clusters_snic_pred = snic_pred.select("clusters")


var vectors_pred = clusters_snic_pred.reduceToVectors({
  geometryType: 'polygon',
  reducer: ee.Reducer.countEvery(),
  scale: 20,
  maxPixels: 1e13,
  geometry: AOI,
}).aside(print,'reduceToVectors'); // FeatureCollection (422 elements, 3 columns)


// columns: Object (3 properties)
// count: Long<0, 4294967295>
// label: Integer
// system:index: String
// features: List (422 elements)
// 0: Feature +401214+190140 (Polygon, 2 properties)
// type: Feature
// id: +401214+190140
// geometry: Polygon, 88 vertices
// type: Polygon
// coordinates: List (2 elements)
// 0: List (83 elements)
// 1: List (5 elements)
// geodesic: false
// properties: Object (2 properties)
// count: 331
// label: -447560355


var empty_pred = ee.Image().byte().aside(print,'byte');

// Image (1 band)
// type: Image
// bands: List (1 element)
// 0: "constant", unsigned int8, EPSG:4326
// id: constant
// crs: EPSG:4326
// crs_transform: [1,0,0,0,1,0]
// data_type: unsigned int8

var outline_pred = empty_pred.paint({
  featureCollection: vectors_pred,
  color: 1,
  width: 1
}).aside(print,'paint');

// Image (1 band)
// type: Image
// bands: List (1 element)
// 0: "constant", unsigned int8, EPSG:4326
// id: constant
// crs: EPSG:4326
// crs_transform: [1,0,0,0,1,0]
// data_type: unsigned int8

Map.addLayer(outline_pred, {palette: 'FF0000'}, 'vec_snic_pred');


//---------------- Classification ----------------------------

var FullImage = RGBVH.addBands(RGBVV).toFloat().aside(print,'toFloat') //Image (6 bands)

// bands: List (6 elements)
// 0: "VH", float, EPSG:4326, 1x1 px
// 1: "VH_1", float, EPSG:4326, 1x1 px
// 2: "VH_2", float, EPSG:4326, 1x1 px
// 3: "VV", float, EPSG:4326, 1x1 px
// 4: "VV_1", float, EPSG:4326, 1x1 px
// 5: "VV_2", float, EPSG:4326, 1x1 px
// properties: Object (1 property)
// system:footprint: Polygon, 5 vertices
// type: Polygon
// coordinates: List (1 element)
// 0: List (5 elements)
// geodesic: false

var train_points = No_crop.merge(Crop_fields).aside(print,'pretrainedpoints') //FeatureCollection (162 elements, 2 columns)

// columns: Object (2 properties)
// Class: Integer
// system:index: String
// features: List (162 elements)
// 0: Feature 1_0 (Point, 1 property)
// type: Feature
// id: 1_0
// geometry: Point (72.12, 34.15)
// type: Point
// coordinates: [72.12326247571131,34.15080992471748]
// properties: Object (1 property)
// Class: 0


var train_polys = vectors_pred.aside(print,'vectors_pred') //分割FeatureCollection (422 elements, 3 columns)

// columns: Object (3 properties)
// count: Long<0, 4294967295>
// label: Integer
// system:index: String
// features: List (422 elements)
// 0: Feature +401214+190140 (Polygon, 2 properties)
// type: Feature
// id: +401214+190140
// geometry: Polygon, 88 vertices
// type: Polygon
// coordinates: List (2 elements)
// 0: List (83 elements)
// 1: List (5 elements)
// geodesic: false
// properties: Object (2 properties)
// count: 331
// label: -447560355

  .map(function(feat){
  feat = ee.Feature(feat);
  var point = feat.geometry();
//whether intersects
  var mappedPolys = train_points.map(function(poly){
    var cls = poly.get("Class")
    var intersects = poly.intersects(point, ee.ErrorMargin(1));
    var property = ee.String(ee.Algorithms.If(intersects, 'TRUE', 'FALSE'));
    return feat.set('belongsTo',  property).set('Class', cls);
  });
  return mappedPolys;
}).aside(print,'map') //FeatureCollection (422 elements, 0 columns)

// columns: Object (5 properties)
// Class: Integer
// belongsTo: String
// count: Long
// label: Long
// system:index: String

.flatten().aside(print,'flatten')
.filter(ee.Filter.neq('belongsTo', 'FALSE')).aside(print,'belongsToFALSEintersects');
//FeatureCollection (162 elements, 0 columns)none intersect remained

// 0: Feature +401350+190107_1_6 (Polygon, 4 properties)
// type: Feature
// id: +401350+190107_1_6
// geometry: Polygon, 269 vertices
  // type: Polygon
  // coordinates: List (7 elements)
    // 0: List (233 elements)
    // 1: List (7 elements)
    // 2: List (5 elements)
    // 3: List (9 elements)
    // 4: List (5 elements)
    // 5: List (5 elements)
    // 6: List (5 elements)
    
  // geodesic: false

// properties: Object (4 properties)
  // Class: 0
  // belongsTo: TRUE
  // count: 1370
  // label: -1307019721




var train_areas = train_polys //FeatureCollection (162 elements
  .reduceToImage({
    properties: ['Class'],
    reducer: ee.Reducer.first()
}).aside(print,'reduceToImage') //"first", double, EPSG:4326 Image (1 band)

// bands: List (1 element)
// 0: "first", double, EPSG:4326

.rename('Class').toInt().aside(print,'reduceToImagetoInt'); //"Class", signed int32, EPSG:4326 Image (1 band)

// bands: List (1 element)
// 0: "Class", signed int32, EPSG:4326


var vis_RF = {min: 0, max: 1,
palette: [ 'yellow' //0
,'green']//1
}

Map.addLayer(train_areas,vis_RF,"clip_img");

var predict_image = vectors_pred
  .reduceToImage({
    properties: ['label'],
    reducer: ee.Reducer.first()
}).rename('id').toInt();



FullImage = FullImage.addBands(predict_image).aside(print,'FullImage')//Image (7 bands)"id", signed int32, EPSG:4326

// bands: List (7 elements)
// 0: "VH", float, EPSG:4326, 1x1 px
// 1: "VH_1", float, EPSG:4326, 1x1 px
// 2: "VH_2", float, EPSG:4326, 1x1 px
// 3: "VV", float, EPSG:4326, 1x1 px
// 4: "VV_1", float, EPSG:4326, 1x1 px
// 5: "VV_2", float, EPSG:4326, 1x1 px
// 6: "id", signed int32, EPSG:4326

//对每个“对象”中的所有像素应用减速器。
//如果像素是连接的(8-way)，并且在“label”带中具有相同的值，则认为它们属于一个对象。
//标签带仅用于识别连接性;其余的作为减速器的投入提供。

var FullImage_mean = FullImage.reduceConnectedComponents({
  reducer: ee.Reducer.mean(),
  labelBand: 'id'
});

var FullImage_max = FullImage.reduceConnectedComponents({
  reducer: ee.Reducer.max(),
  labelBand: 'id'
});

var FullImage_min = FullImage.reduceConnectedComponents({
  reducer: ee.Reducer.min(),
  labelBand: 'id'
});

var FullImage_std = FullImage.reduceConnectedComponents({
  reducer: ee.Reducer.stdDev(),
  labelBand: 'id'
});

var FullImage_median = FullImage.reduceConnectedComponents({
  reducer: ee.Reducer.median(),
  labelBand: 'id'
});


var FullImage_area = ee.Image.pixelArea() 
    //生成一个图像，其中每个像素的值是该像素的面积，以平方米为单位。
    // 返回的图像有一个单一的波段，称为“区域”。
    .addBands(FullImage.select('id')).reduceConnectedComponents(ee.Reducer.sum(), 'id')
var FullImage_sizes = ee.Image.pixelLonLat()
    //创建一个带有两个带区的图像，分别命名为“经度”和“纬度”，其中包含每个像素处的经度和纬度，单位为度。
    .addBands(FullImage.select('id')).reduceConnectedComponents(ee.Reducer.minMax(), 'id')
var FullImage_width = FullImage_sizes.select('longitude_max').subtract(FullImage_sizes.select('longitude_min')).rename('width')
var FullImage_height = FullImage_sizes.select('latitude_max').subtract(FullImage_sizes.select('latitude_min')).rename('height')


// join features in an image

var Pred_bands = ee.Image.cat([
  FullImage_mean,
  FullImage_max,
  FullImage_std,
  FullImage_median,
  FullImage_min,
  FullImage_area,
  FullImage_width,
  FullImage_height
]).float();

var predictionBands = Pred_bands.bandNames();

Pred_bands = Pred_bands.addBands(train_areas)

var training = Pred_bands.sample(train_points, 20).aside(print,'sample'); //FeatureCollection (159 elements, 34 columns)





var withRandom = training.randomColumn('random').aside(print,'randomColumn'); //FeatureCollection (159 elements, 35 columns)

// columns: Object (35 properties)
// Class: Integer
// VH: Float
// VH_1: Float
// VH_1_1: Float
// VH_1_2: Float
// VH_1_3: Float
// VH_1_4: Float
// VH_2: Float
// VH_2_1: Float
// VH_2_2: Float
// VH_2_3: Float
// VH_2_4: Float
// VH_3: Float
// VH_4: Float
// VH_5: Float
// VH_6: Float
// VV: Float
// VV_1: Float
// VV_1_1: Float
// VV_1_2: Float
// VV_1_3: Float
// VV_1_4: Float
// VV_2: Float
// VV_2_1: Float
// VV_2_2: Float
// VV_2_3: Float
// VV_2_4: Float
// VV_3: Float
// VV_4: Float
// VV_5: Float
// VV_6: Float
// area: Float
// height: Float
// random: <any>
// width: Float

var split = 0.7;  // Roughly 70% training, 30% testing.
var trainingPartition = withRandom.filter(ee.Filter.lt('random', split));
var testingPartition = withRandom.filter(ee.Filter.gte('random', split));



var trainedClassifier = ee.Classifier.smileRandomForest({numberOfTrees:100}).train({
  features: trainingPartition,
  classProperty: 'Class',
  inputProperties: predictionBands
}).aside(print,'smileRandomForest'); //Classifier.train

// Classify the test FeatureCollection.
var test = testingPartition.classify(trainedClassifier).aside(print,'classifytestingPartition'); //FeatureCollection (40 elements, 0 columns)

// properties: Object (36 properties)
// Class: 1
// VH: -17.987802505493164
// VH_1: -20.446969985961914
// VH_1_1: -11.336684226989746
// VH_1_2: 3.3291358947753906
// VH_1_3: -20.062349319458008
// VH_1_4: -33.47245788574219
// VH_2: -17.077720642089844
// VH_2_1: -9.73388671875
// VH_2_2: 2.562696933746338
// VH_2_3: -16.998180389404297
// VH_2_4: -29.42670440673828
// VH_3: -12.933541297912598
// VH_4: 1.8077919483184814
// VH_5: -17.833660125732422
// VH_6: -26.73664093017578
// VV: -11.59115219116211
// VV_1: -11.277421951293945
// VV_1_1: -4.749847412109375
// VV_1_2: 2.2022743225097656
// VV_1_3: -11.439092636108398
// VV_1_4: -17.398120880126953
// VV_2: -9.193023681640625
// VV_2_1: -4.1558308601379395
// VV_2_2: 1.736317753791809
// VV_2_3: -9.131431579589844
// VV_2_4: -16.674373626708984
// VV_3: -6.673230171203613
// VV_4: 1.861851453781128
// VV_5: -11.662367820739746
// VV_6: -16.886898040771484
// area: 163784.625
// classification: 1
// height: 0.00413225032389164
// random: 0.937686345029616
// width: 0.005030565429478884

var classified_RF = Pred_bands.select(predictionBands).classify(trainedClassifier).aside(print,'classifyPred_bands'); //Image (1 band)  "classification", signed int32

Map.addLayer(classified_RF, vis_RF, 'Classified');


// Print the confusion matrix.
var confusionMatrix = test.errorMatrix('Class', 'classification').aside(print,'errorMatrix');

print('Confusion Matrix', confusionMatrix); //[[23,2],[0,15]]
print('Validation overall accuracy: ', confusionMatrix.accuracy()); //0.95


var ag_mask = classified_RF.eq(1)

ag_mask = ag_mask.updateMask(ag_mask)

var ag_vec = ag_mask.reduceToVectors({
  geometryType: 'polygon',
  reducer: ee.Reducer.countEvery(),
  scale: 20,
  maxPixels: 1e13,
  geometry: AOI,
});

Map.addLayer(ag_vec,{color:'green'},'Vec_agric')

print('Area em Ha: ',ag_vec.geometry().area(1).divide(100 * 100)) //2381.7499395289565









